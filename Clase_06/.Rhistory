knitr::opts_chunk$set(echo = FALSE)
messy_salmon <- read_excel("Messy_salmon.xlsx", sheet=1)
library(readxl)
library(stats)
library(dplyr)
library(tidyr)
library(ggplot2)
library(forcats) # To reorder levels in a factor
messy_salmon <- read_excel("Messy_salmon.xlsx", sheet=1)
View(messy_salmon)
View(messy_salmon)
colnames(messy_salmon)
messy_salmon %>% spread("Ploidy", "Family", "Tank")
messy_salmon %>% spread("Ploidy", "Family")
messy_salmon %>% spread("Ploidy", "Weight")
messy_salmon <- read_excel("Messy_salmon.xlsx", sheet=1)
messy_salmon %>% spread("Family", "Weight")
View(messy_salmon)
messy_salmon %>% spread("Family", "Weight")
messy_salmon %>% spread("Ploidy", "Weight")
messy_salmon %>% spread("Ploidy","Family")
messy_salmon %>% spread("Family", "Weight")
messy_salmon$Family <- as.factor(messy_salmon$Family)
messy_salmon %>% spread("Family", "Weight")
messy_salmon$Ploidy <- as.factor(messy_salmon$Ploidy)
messy_salmon %>% spread("Family", "Weight")
df <- data.frame(x = c("a", "b"), y = c(3, 4), z = c(5, 6))
View(df)
df %>% spread(x, y)
View(df)
df %>% spread(z, y)
df %>% spread(z, X)
df %>% spread(z, x)
messy_salmon %>% spread("Family", Weight)
messy_salmon %>% spread(Family, Weight)
View(messy_salmon)
messy_salmon %>% spread(Family)
messy_salmon %>% spread(Family, Weight)
messy_salmon %>% spread(Family, casa)
View(messy_salmon)
messy_salmon %>% spread("Family", "Weight")
messy_salmon %>% spread(Family, Weight)
messy_salmon %>% spread(Family, Weight)
messy_salmon <- read_excel("Messy_salmon.xlsx", sheet=1)
View(messy_salmon)
messy_salmon %>% spread(Family, Weight)
messy_salmon <- read_excel("Messy_salmon.xlsx", sheet=1)
messy_salmon$Family <- as.factor(messy_salmon$Family)
messy_salmon$Ploidy <- as.factor(messy_salmon$Ploidy)
messy_salmon %>% spread(Family, Weight)
messy_salmon <- read_excel("Messy_salmon.xlsx", sheet=1)
messy_salmon$Family <- as.factor(messy_salmon$Family)
messy_salmon$Ploidy <- as.factor(messy_salmon$Ploidy)
messy_salmon %>% spread(Family, Weight)
messy_salmon <- read_excel("Messy_salmon.xlsx", sheet=1)
messy_salmon$Family <- as.factor(messy_salmon$Family)
messy_salmon$Ploidy <- as.factor(messy_salmon$Ploidy)
messy_salmon %>% spread(Ploidy, Weight)
messy_salmon <- read_excel("Messy_salmon.xlsx", sheet=1)
messy_salmon$Family <- as.factor(messy_salmon$Family)
messy_salmon$Ploidy <- as.factor(messy_salmon$Ploidy)
messy_salmon %>% spread(Ploidy, Family, Weight)
messy_salmon <- read_excel("Messy_salmon.xlsx", sheet=1)
messy_salmon$Family <- as.factor(messy_salmon$Family)
messy_salmon$Ploidy <- as.factor(messy_salmon$Ploidy)
messy_salmon %>% spread(Ploidy, Weight)
messy_salmon <- read_excel("Messy_salmon.xlsx", sheet=1)
messy_salmon$Family <- as.factor(messy_salmon$Family)
messy_salmon$Ploidy <- as.factor(messy_salmon$Ploidy)
messy_salmon %>% spread(Family, Weight)
messy_salmon <- read_excel("Messy_salmon.xlsx", sheet=1)
messy_salmon$Family <- as.factor(messy_salmon$Family)
messy_salmon$Ploidy <- as.factor(messy_salmon$Ploidy)
messy_salmon %>% spread(Ploidy, Weight)
messy_salmon %>% spread(Ploidy, Weight) %>%
write.csv(file = "messy.csv", row.names = FALSE)
messy_salmon <- read_excel("Messy_salmon.xlsx", sheet=1)
View(messy_salmon)
head(messy_salmon)
messy_salmon %>% gather("Ploidy", "Weight")
head(messy_salmon)
messy_salmon <- read_excel("Messy_salmon.xlsx", sheet=1)
head(messy_salmon)
messy_salmon %>% gather("Ploidy", "Weight", 3:4)
knitr::opts_chunk$set(echo = FALSE)
knitr::include_graphics("Messy_Salmon.png")
messy_salmon <- read_excel("Messy_salmon.xlsx", sheet=1)
messy_salmon <- read_excel("salmon.xlsx", sheet=1)
library(readxl)
library(dplyr)
library(tidyr)
library(ggplot2)
library(forcats) # To reorder levels in a factor
messy_salmon <- read_excel("salmon.xlsx", sheet=1)
head(messy_salmon)
messy_salmon %>% gather("Ploidy", "Weight", 3:4)
messy_salmon <- read_excel("salmon.xlsx", sheet=2)
head(messy_salmon)
messy_salmon %>% gather("Ploidy", "Weight", 3:4)
messy_salmon <- read_excel("salmon.xlsx", sheet=2)
head(messy_salmon)
messy_salmon %>% gather("Ploidy", "Weight", 3:4)
messy_salmon <- read_excel("salmon.xlsx", sheet=2)
head(messy_salmon)
messy_salmon %>% gather("Ploidy", "Weight", 3:4)
tidy_salmon <- messy_salmon %>% gather("Ploidy", "Weight", 3:4)
head(tidy_salmon)
head(tidy_salmon)
str(tidy_salmon)
tidy_salmon$Sample <- as.factor(tidy_salmon$Sample)
tidy_salmon$Family <- as.factor(tidy_salmon$Family)
tidy_salmon$Ploidy <- as.numeric(tidy_salmon$Ploidy)
summary(tidy_salmon)
table(tidy_salmon$Family, tidy_salmon$Ploidy)
str(tidy_salmon)
View(tidy_salmon)
View(tidy_salmon)
View(messy_salmon)
messy_salmon <- read_excel("salmon.xlsx", sheet=2)
head(messy_salmon)
messy_salmon %>% gather("Ploidy", "Weight", 3:4)
tidy_salmon <- messy_salmon %>% gather("Ploidy", "Weight", 3:4)
str(tidy_salmon)
tidy_salmon$Sample <- as.factor(tidy_salmon$Sample)
tidy_salmon$Family <- as.factor(tidy_salmon$Family)
tidy_salmon$Ploidy <- aas.factor(tidy_salmon$Ploidy)
tidy_salmon$Sample <- as.factor(tidy_salmon$Sample)
tidy_salmon$Family <- as.factor(tidy_salmon$Family)
tidy_salmon$Ploidy <- as.factor(tidy_salmon$Ploidy)
summary(tidy_salmon)
table(tidy_salmon$Family, tidy_salmon$Ploidy)
na.omit(tidy_salmon)
na.omit(tidy_salmon) %>% table(tidy_salmon$Family, tidy_salmon$Ploidy)
na.omit(tidy_salmon)
tidy_salmon <- na.omit(tidy_salmon)
table(tidy_salmon$Family, tidy_salmon$Ploidy)
messy_salmon <- read_excel("salmon.xlsx", sheet=2)
head(messy_salmon)
messy_salmon %>% gather("Ploidy", "Weight", 3:4)
tidy_salmon <- messy_salmon %>% gather("Ploidy", "Weight", 3:4)
messy_salmon <- read_excel("salmon.xlsx", sheet=2)
messy_salmon %>% gather("Ploidy", "Weight", 3:4)
tidy_salmon <- messy_salmon %>% gather("Ploidy", "Weight", 3:4)
head(tidy_salmon)
str(tidy_salmon)
tidy_salmon$Sample <- as.factor(tidy_salmon$Sample)
tidy_salmon$Family <- as.factor(tidy_salmon$Family)
tidy_salmon$Ploidy <- as.factor(tidy_salmon$Ploidy)
summary(tidy_salmon)
na.omit(tidy_salmon)
tidy_salmon <- na.omit(tidy_salmon)
tidy_salmon <- na.omit(tidy_salmon)
summary(tidy_salmon)
table(tidy_salmon$Family, tidy_salmon$Ploidy)
tidy_salmon <- read_excel("salmon.xlsx", sheet=3)
tidy_salmon %>%
filter(Ploidy == "Triploid")
tidy_salmon %>%
filter(Ploidy == "Triploid", Family == "11")
tidy_salmon %>%
filter(Ploidy == "Triploid")%>%
summarize(mean(Weight))
tidy_salmon %>%
filter(Ploidy == "Diploy")%>%
summarize(mean(Weight))
tidy_salmon %>%
filter(Ploidy == "Diploid")%>%
summarize(mean(Weight))
tidy_salmon %>%
filter(Ploidy == "Diploid")%>%
summarize(n(), mean(Weight), median(Weight), min(Weight), max(Weight), sd(Weight))
tidy_salmon %>%
filter(Group == "Vaccinated")%>%
summarize("N"=n(), "Mean"=mean(Weight), "Median"= median(Weight), "Minimun"=min(Weight), "Maximun"=max(Weight), "Standard deviation"=sd(Weight))
tidy_salmon %>%
filter(Ploidy == "Diploid")%>%
summarize("N"=n(), "Mean"=mean(Weight), "Median"= median(Weight), "Minimun"=min(Weight), "Maximun"=max(Weight), "Standard deviation"=sd(Weight))
Table <- tidy_salmon %>%
filter(Ploidy == "Diploid")%>%
summarize("N"=n(), "Mean"=mean(Weight), "Median"= median(Weight), "Minimun"=min(Weight), "Maximun"=max(Weight), "Standard deviation"=sd(Weight))
knitr::kable(Table, caption = "Tabla 1. Resumen de respuesta de IFN en animales no vacunados.")
tidy_salmon %>%
group_by(Ploidy)%>%
summarize("N"=n(), "Mean"=mean(Weight), "Median"= median(Weight), "Minimun"=min(Weight), "Maximun"=max(Weight), "Standard deviation"=sd(Weight))
Table <- tidy_salmon %>%
group_by(Ploidy)%>%
summarize("N"=n(), "Mean"=mean(Weight), "Median"= median(Weight), "Minimun"=min(Weight), "Maximun"=max(Weight), "Standard deviation"=sd(Weight))
knitr::kable(Table, caption = "Tabla 1. Resumen de respuesta de IFN en animales no vacunados.")
knitr::opts_chunk$set(echo = FALSE)
tidy_salmon %>%
filter(Ploidy == "Triploid", Family == "11")
knitr::opts_chunk$set(echo = FALSE)
library(readxl)
library(dplyr)
library(tidyr)
library(ggplot2)
library(forcats) # To reorder levels in a factor
knitr::include_graphics("Messy_Salmon.png")
messy_salmon <- read_excel("salmon.xlsx", sheet=2)
messy_salmon %>% gather("Ploidy", "Weight", 3:4)
tidy_salmon <- messy_salmon %>% gather("Ploidy", "Weight", 3:4)
str(tidy_salmon)
tidy_salmon$Sample <- as.factor(tidy_salmon$Sample)
tidy_salmon$Family <- as.factor(tidy_salmon$Family)
tidy_salmon$Ploidy <- as.factor(tidy_salmon$Ploidy)
summary(tidy_salmon)
tidy_salmon <- na.omit(tidy_salmon)
summary(tidy_salmon)
tidy_salmon <- read_excel("salmon.xlsx", sheet=3)
tidy_salmon <- read_excel("salmon.xlsx", sheet=3)
head(tidy_salmon)
tidy_salmon %>%
filter(Ploidy == "Triploid", Family == "11")
tidy_salmon %>%
filter(Ploidy == "Diploid")%>%
summarize(mean(Weight))
tidy_salmon %>%
filter(Ploidy == "Diploid")%>%
summarize(n(), mean(Weight), median(Weight), min(Weight), max(Weight), sd(Weight))
tidy_salmon %>%
filter(Ploidy == "Diploid")%>%
summarize("N"=n(), "Mean"=mean(Weight), "Median"= median(Weight), "Minimun"=min(Weight), "Maximun"=max(Weight), "Standard deviation"=sd(Weight))
View(tidy_salmon)
tidy_salmon %>%
group_by(Ploidy)%>%
summarize("N"=n(), "Weight (Mean)"=mean(Weight), "Weight (sd)"=sd(Weight), "Length (Mean)"=mean(Weight), "Length (sd)"=sd(Weight))
ggplot(tidy_salmon, aes(x= Ploidy))+
geom_bar()
tidy_salmon %>% ggplot(aes(x= Ploidy))+
geom_bar()
ggplot(tidy_salmon, aes(x= Ploidy, fill=Ploidy))+
geom_bar()
tidy_salmon %>%  ggplot(aes(x= Ploidy))+
geom_bar()
tidy_salmon %>%  ggplot(aes(x= Ploidy, fill=Ploidy))+
geom_bar()
tidy_salmon %>%  ggplot(aes(x= Ploidy, fill=Ploidy))+
geom_bar()+
labs(x= "", caption = "Fuente: Parlane et al, 2014")
tidy_salmon %>%  ggplot(aes(x= Ploidy, fill=Ploidy))+
geom_bar()+
labs(x= "", caption = "Fuente: Harvey et al., 2017")
tidy_salmon %>%  ggplot(aes(x= Ploidy, fill=Ploidy))+
geom_bar()+
labs(caption = "Fuente: Harvey et al., 2017")
tidy_salmon %>%  ggplot(aes(x= Ploidy, fill=Ploidy))+
geom_bar()+
labs(x= "", caption = "Fuente: Harvey et al., 2017")
tidy_salmon %>%  ggplot(aes(x= Ploidy, fill=Ploidy))+
geom_bar()+
labs(x= "", caption = "Fuente: Harvey et al., 2017")
tidy_salmon %>%  ggplot(aes(x= Ploidy, fill=Ploidy))+
geom_bar()+
labs(x= "", caption = "Fuente: Harvey et al., 2017")+
facet_wrap(~ Week)
tidy_salmon %>%  ggplot(aes(x= Ploidy, fill=Ploidy))+
geom_bar()+
labs(x= "", caption = "Fuente: Harvey et al., 2017")+
facet_wrap(~ Family)
tidy_salmon %>%  mutate(Weight/(Length^3)*100)
tidy_salmon <- tidy_salmon %>%  mutate(K=(Weight/(Length^3)*100))
tidy_salmon <- tidy_salmon %>%  mutate(K=(Weight/(Length^3)*100))
tidy_plot <- tidy_salmon %>%  group_by(Ploidy, Family) %>% summarize(n=n(), mean = mean(K), sd=sd(K))
head(tidy_plot)
tidy_plot <- tidy_salmon %>%  group_by(Ploidy, Family) %>% summarize(n=n(), "K (mean" = mean(K), "F (sd)"=sd(K))
head(tidy_plot)
tidy_plot <- tidy_salmon %>%  group_by(Ploidy, Family) %>% summarize(n=n(), "K (mean)" = mean(K), "K (sd)"=sd(K))
head(tidy_plot)
tidy_plot <- tidy_salmon %>%  group_by(Family, Ploidy) %>% summarize(n=n(), "K (mean)" = mean(K), "K (sd)"=sd(K))
head(tidy_plot)
tidy_plot <- tidy_salmon %>%  group_by(Family, Ploidy) %>% summarize(n=n(), "K (mean)" = mean(K), "K (sd)"=sd(K))
head(tidy_plot)
View(tidy_salmon)
tidy_plot <- tidy_salmon %>%  group_by(Family) %>% summarize(n=n(), "K (mean)" = mean(K), "K (sd)"=sd(K))
head(tidy_plot)
tidy_plot <- tidy_salmon %>%  groups(Family, Ploidy) %>% summarize(n=n(), "K (mean)" = mean(K), "K (sd)"=sd(K))
tidy_plot <- tidy_salmon %>%  group_by(Ploidy) %>% summarize(n=n(), "K (mean)" = mean(K), "K (sd)"=sd(K))
head(tidy_plot)
tidy_plot <- tidy_salmon %>%  group_by(Ploidy, Family) %>% summarize(n=n(), "K (mean)" = mean(K), "K (sd)"=sd(K))
head(tidy_plot)
tidy_plot <- tidy_salmon %>%  group_by(Family, Ploidy) %>% summarize(n=n(), "K (mean)" = mean(K), "K (sd)"=sd(K))
head(tidy_plot)
tidy_plot <- tidy_salmon %>%  group_by(Family, Ploidy, add = TRUE) %>% summarize(n=n(), "K (mean)" = mean(K), "K (sd)"=sd(K))
head(tidy_plot)
tidy_plot <- tidy_salmon %>%  group_by(Family, Ploidy, .add = TRUE) %>% summarize(n=n(), "K (mean)" = mean(K), "K (sd)"=sd(K))
head(tidy_plot)
tidy_plot <- tidy_salmon %>%  group_by(Family, Ploidy, .drop = FALSE) %>% summarize(n=n(), "K (mean)" = mean(K), "K (sd)"=sd(K))
head(tidy_plot)
tidy_plot <- tidy_salmon %>%  group_by(Family) %>% summarize(n=n(), "K (mean)" = mean(K), "K (sd)"=sd(K))
head(tidy_plot)
tidy_plot <- tidy_salmon %>%  group_by(Family, Ploidy)
tidy_salmon %>%  group_by(Family, Ploidy)
tidy_salmon %>%  group_by(Family, Ploidy) %>% summarize(n=n()
tidy_salmon %>%  group_by(Family, Ploidy) %>% summarize(n=n())
tidy_salmon %>%  group_by(Family, Ploidy) %>% summarize(n=n(), mean(K))
tidy_salmon %>%  group_by(Family, Ploidy) %>% summarize(n=n(), mean(K), "K (sd)"=sd(K))
tidy_plot <- tidy_salmon %>%  group_by(Family, Ploidy) %>% summarize(n=n(), "K (mean)" = mean(K), "K (sd)"=sd(K))
tidy_plot
tidy_plot <- tidy_salmon %>%  group_by(Family) %>% summarize(n=n(), "K (mean)" = mean(K), "K (sd)"=sd(K))
tidy_plot
tidy_plot <- tidy_plot %>%
mutate("K error" = sd/sqrt(n))
tidy_plot <- tidy_plot %>%
mutate("K error" = `K (sd)`/sqrt(n))
head(tidy_plot)
tidy_plot %>%
ggplot(aes(x=Family, y= `K (mean)`, color=Family, group=Family))
tidy_plot %>%
ggplot(aes(x=Family, y= `K (mean)`, color=Family, group=Family))+
geom_line()
tidy_plot %>%
ggplot(aes(x=Family, y= `K (mean)`, color=Family))+
geom_line()
tidy_plot %>%
ggplot(aes(x=Family, y= `K (mean)`))+
geom_line()
tidy_plot %>%
ggplot(aes(x=Family, y= `K (mean)`))+
geom_point()
tidy_plot %>%
ggplot(aes(x=Family, y= `K (mean)`, color=Family, group=Family))+
geom_point()
tidy_plot %>%
ggplot(aes(x=Family, y= `K (mean)`, color=Family, group=Family))+
geom_point()
tidy_plot %>%
ggplot(aes(x=Family, y= `K (mean)`, color=Family, group=Family))+
geom_point()+
geom_errorbar(aes(ymin=mean-error, ymax=mean+error), width=.2,
position=position_dodge(0.05))
tidy_plot <- tidy_plot %>%
mutate("K (error") = `K (sd)`/sqrt(n))
tidy_plot <- tidy_salmon %>%  group_by(Family) %>% summarize(n=n(), "K (mean)" = mean(K), "K (sd)"=sd(K))
tidy_plot
tidy_plot <- tidy_plot %>%
mutate("K (error") = `K (sd)`/sqrt(n))
tidy_plot <- tidy_plot %>%
mutate("K (error)" = `K (sd)`/sqrt(n))
head(tidy_plot)
tidy_plot %>%
ggplot(aes(x=Family, y= `K (mean)`, color=Family, group=Family))
tidy_plot %>%
ggplot(aes(x=Family, y= `K (mean)`, color=Family, group=Family))+
geom_point()
tidy_plot %>%
ggplot(aes(x=Family, y= `K (mean)`, color=Family, group=Family))+
geom_point()+
geom_errorbar(aes(ymin=`K (mean)`-`K (error)`, ymax=`K (mean)`-`K (error)), width=.2,
position=position_dodge(0.05))
tidy_plot %>%
ggplot(aes(x=Family, y= `K (mean)`, color=Family, group=Family))+
geom_point()+
geom_errorbar(aes(ymin=`K (mean)`-`K (error)`, ymax=`K (mean)`-`K (error)`), width=.2,
position=position_dodge(0.05))
tidy_plot %>%
ggplot(aes(x=Family, y= `K (mean)`, color=Family, group=Family))+
geom_point()+
geom_errorbar(aes(ymin=`K (mean)`-`K (error)`, ymax=`K (mean)`+`K (error)`), width=.2,
position=position_dodge(0.05))
tidy_plot %>%
ggplot(aes(x=Family, y= `K (mean)`, color=Family, group=Family))
tidy_plot %>%
ggplot(aes(x=Family, y= `K (mean)`, color=Family, group=Family))+
geom_point()
tidy_plot %>%
ggplot(aes(x=Family, y= `K (mean)`, color=Family, group=Family))+
geom_point()+
geom_errorbar(aes(ymin=`K (mean)`-`K (error)`, ymax=`K (mean)`+`K (error)`), width=.2,
position=position_dodge(0.05))
